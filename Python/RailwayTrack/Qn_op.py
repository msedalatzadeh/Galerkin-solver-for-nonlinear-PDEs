def Qn_op(N,par,block_diag):
    #par=[EI,rhoa,k,l,alpha,delta,mu,Cd,cw,cv,cu]
    EI=par[0]
    k=par[2]
    rhoa=par[1]
    l=par[3]
    cw=par[8]
    cv=par[9]
    n=1
    c=(2*l**3*3.141592653589793**4*n**4)/(EI*3.141592653589793**4*\
            n**4+k*l**4+rhoa*l**4*3.141592653589793**4*n**4)
    Qn=[[c*(cv*rhoa*3.141592653589793**4*l**4*n**4 + cw*k*l**4 + \
          EI*cw*3.141592653589793**4*n**4)/(2*l**3*n**4*3.141592653589793**4),\
        -c*(-cv*rhoa*3.141592653589793**4*l**4*n**4 + cw*k*l**4 + \
          EI*cw*3.141592653589793**4*n**4)/(2*l**3*n**4*3.141592653589793**4)],
         [-c*(-cv*rhoa*3.141592653589793**4*l**4*n**4 + cw*k*l**4 +\
          EI*cw*3.141592653589793**4*n**4)/(2*l**3*n**4*3.141592653589793**4),
           c*(cv*rhoa*3.141592653589793**4*l**4*n**4 + cw*k*l**4 +\
        EI*cw*3.141592653589793**4*n**4)/(2*l**3*n**4*3.141592653589793**4)]]    
    for n in range(2,(N//2+1)):
        Q=[[c*(cv*rhoa*3.141592653589793**4*l**4*n**4 + cw*k*l**4 + \
          EI*cw*3.141592653589793**4*n**4)/(2*l**3*n**4*3.141592653589793**4),\
        -c*(-cv*rhoa*3.141592653589793**4*l**4*n**4 + cw*k*l**4 + \
          EI*cw*3.141592653589793**4*n**4)/(2*l**3*n**4*3.141592653589793**4)],
         [-c*(-cv*rhoa*3.141592653589793**4*l**4*n**4 + cw*k*l**4 +\
          EI*cw*3.141592653589793**4*n**4)/(2*l**3*n**4*3.141592653589793**4),
           c*(cv*rhoa*3.141592653589793**4*l**4*n**4 + cw*k*l**4 +\
        EI*cw*3.141592653589793**4*n**4)/(2*l**3*n**4*3.141592653589793**4)]]
        Qn=block_diag(Qn,Q)
    return Qn